\documentclass{article}

\input{../preamble.sty}
\usepackage{lmodern}

\newcommand{\OLS}{\bar{\beta}}
\newcommand{\REG}{\hat{\beta}}
\def\qed{\hfill $\Box$\newline}
\newcommand{\ag}[1]{{\bf{{\red{[{AG: #1}]}}}}}
\newcommand{\jt}[1]{{\bf{{\red{[{JT: #1}]}}}}}
\newcommand{\InnerProduct}[2]{\langle #1,#2 \rangle}
\newcommand{\Norm}[1]{\|#1\|}
\newcommand{\bP}{\mathbb{P}}
\newcommand{\Q}{\mathbb{Q}}
\newcommand{\M}{\mathbb{M}}
\newcommand{\V}{\mathbb{V}}
\newcommand{\br}{{\bf r}}
\newcommand{\bs}{{\bf s}}
\newcommand{\bt}{{\boldsymbol t}}
\newcommand{\bH}{{\boldsymbol H}}
\newcommand{\Newton}{\mathrm{Newton}}
\newcommand{\DummyField}{{\tt f}}
\newcommand{\DummyGradient}{{\bf g}}
\newcommand{\InformationMatrix}{{\boldsymbol J}}
\newcommand{\lin}{\mathrm{lin}}
\newcommand{\ind}{\perp\!\!\!\!\perp} 
\newcommand{\Exp}{\mathrm{Exp}}

\newcommand{\RandomField}{Y}
\newcommand{\bLambda}{{\boldsymbol \Lambda}}
\newcommand{\bGamma}{{\boldsymbol \Gamma}}
\newcommand{\Err}{\mathrm{Err}}
\newcommand{\bQ}{{\boldsymbol Q}}
\newcommand{\bJ}{{\boldsymbol J}}
\newcommand{\bV}{{\boldsymbol V}}
\newcommand{\bI}{{\boldsymbol I}}
\newcommand{\bC}{{\boldsymbol C}}
\newcommand{\convweak}{\overset{d}{\to}}

\newcommand{\appropto}{\mathrel{\vcenter{
			\offinterlineskip\halign{\hfil$##$\cr
				\propto\cr\noalign{\kern2pt}\sim\cr\noalign{\kern-2pt}}}}}

\renewcommand{\thealgorithm}{\arabic{algorithm}}
\newcommand{\randsec}{\xi}
\newcommand{\linprocess}{\mathring{\randsec}}
\newcommand{\meansec}{\bar{\mu}}
\newcommand{\indep}{\perp\kern-5pt\perp}

\title{ {\bf Irrepresentability score of a subgradient}}
\author{}

\begin{document}

	\maketitle \RaggedRight

        
        \section{The correct dual problem}

       Recall that the inactive constraints of the
          LASSO can be expressed as
          \begin{equation}
            \label{eq:inactive}
            \|\Lambda_{-E}^{-1}X_{-E}'R_Ey + X_{-E}'X_E(X_E'X_E)^{-1}\Lambda_Es_E\|_{\infty}
            \leq 1
            \end{equation}
          For $M \supset E$ the $M$ coordinates of the problem can be expressed as
          \begin{equation}
            \label{eq:inactive}
            \|\Lambda_{-M}^{-1}X_{-M}'R_My + R_Ey-R_My + X_{-E}'X_E(X_E'X_E)^{-1}\Lambda_Es_E\|_{\infty}
            \leq 1
            \end{equation}
          
          For $v \in \text{col}(P_M)$, we want to be able to compute
          \begin{equation}
            \label{eq:LD}
          \inf_{r: R_Mr=r,  \|\Lambda_{-M}^{-1}X_{-M}'(r + v)\|_{\infty}
            \leq 1} \frac{\|R_Mz\|^2_2}{2}.
          \end{equation}
          If $\|\Lambda_M^{-1}v\|_{\infty} \leq 1$ the value of the program above should be 0.
          As we have assumed $v \in \text{col}(P_M)$, we can write $v=(X_M')^{\dagger}\bar{v}$ with $X_M'v=\bar{v}$.
          This will be used as an {\em irrepresentability score} on the $-M$ coordinates.

          We do this by finding the value of a corresponding dual problem. Specifically, we solve
          $$
          \text{minimize}_{z,z^{\perp}: P_Mz=v, R_Mz^{\perp}=z^{\perp}, \|\Lambda_{-M}^{-1}X_{-M}'(z+z^{\perp})\| \leq 1} \frac{1}{2} \left(\|z\|^2_2 + \|z^{\perp}\|^2_2 \right) - \frac{1}{2} \|v\|^2_2.
          $$
          The final term reflects the fact that by introducing $z$ subject to $P_Mz=v$ we will have modified
          the objective by this constant amount.
          
          The comment above says this is equivalent to the problem
          $$
          \text{minimize}_{z,z^{\perp}: P_Mz=z, X_M'z=\bar{v}, R_Mz^{\perp}=z^{\perp}, \|\Lambda_{-M}^{-1}X_{-M}'(z^{\perp}+z)\| \leq 1} \frac{1}{2} \left(\|z\|^2_2 + \|z^{\perp}\|^2_2 \right) - \frac{1}{2} \|v\|^2_2.
          $$
          
          We introduce a new variable $\alpha_{-M}$ as well as an additional linear constraint $\alpha_{-M}=X_{-M}'(z^{\perp}+z)$ and form the Lagrangian
          $${\cal L}(b_M, b_{-M}|z,z^{\perp},\alpha_{-M}) = \frac{1}{2} \left(\|z\|^2_2 + \|z^{\perp}\|^2_2 \right) + b_M'(X_M'z-\bar{v}) + b_{-M}'(X_{-M}'(z^{\perp}+z) - \alpha_{-M})
          $$
          subject to
          $$
          \begin{aligned}
            P_Mz &= z \\
            R_Mz^{\perp} &= z^{\perp} \\
            \|\Lambda_{-M}^{-1}\alpha_{-M}\|_{\infty} &\leq 1.
            \end{aligned}
          $$

          Let's minimize to find the dual problem. As we should, we do it in groups of terms.
          \begin{description}
            \item[A: $\alpha_{-M}$ terms]
            $$\inf_{\alpha_{-M}: \|\Lambda_{-M}^{-1}\alpha_{-M}\|_{\infty} \leq 1} -b_{-M}'\alpha_{-M} = -\|\Lambda_{-M}b_{-M}\|_1.
              $$
            \item[B: $z$ terms]
              $$
              \inf_{z:P_Mz=z} \frac{1}{2} \|z\|^2_2 + (X_Mb_M)'z + z'(X_{-M}b_{-M}) = -\frac{1}{2}\|P_M(X_Mb_M + X_{-M}b_{-M})\|^2_2
              $$
            \item[C: $z^{\perp}$ terms]
              $$
              \inf_{z^{\perp}: R_Mz^{\perp}=z^{\perp}} \frac{1}{2}\|z^{\perp}\|^2_2 + (z^{\perp})'X_{-M}b_{-M} = -\frac{1}{2} \|R_MX_{-M}b_{-M}\|^2_2
              $$
            \item[Remaining terms]
              The terms $-b_M'\bar{v}$ and $ - \frac{1}{2} \|v\|^2_2$ remain.
          \end{description}

          The dual objective is therefore
          $$
          b \mapsto -\frac{1}{2}\|Xb\|^2_2 - \|\Lambda_{-M}b_{-M}\|_1 - b_M'\bar{v} - \frac{1}{2} \|v\|^2_2
          $$

          \subsection{          Special case $E=M$ }

          In this case $v=X_E(X_E'X_E)^{-1}\Lambda_Es_E$ and $\bar{v}=\Lambda_Es_E$.

          {\bf Sanity check}

          Let's suppose $\|\Lambda_{E-}^{-1}X_{-E}'v\|_{\infty} \leq 1$ then we should be able to set $b_{-E}$ to 0 in the problem
          $$
          \text{minimize}_b \frac{1}{2} \|Xb\|^2_2 + b_E'\Lambda_Es_E + \|\Lambda_{-E}b_{-E}\|_1 + \frac{1}{2} \|v\|^2_2
          $$

          Minimizing over $b_M$ yields $b_E^* =-(X_E'X_E)^{-1}\Lambda_Es_E$ and then the gradient
          on the inactive coordinates at $(b_E^*, 0)$ is
          $$
          -X_{-E}'X_E(X_E'X_E)^{-1}\Lambda_Es_E.
          $$
          By assumption $\|\Lambda_{-E}^{-1}X_{-E}'X_E(X_E'X_E)^{-1}\Lambda_Es_E\|_{\infty} \leq 1$ so we can indeed set $b_{-E}$ to 0.
          The value is now 0 when we plug in the optimal $b_E^*$.

          \subsection{Summary}

          By invoking strong duality, for $v \in \text{col}(P_M)$ the following holds:
          $$
          \begin{aligned}
          \inf_{r: R_Mr=r,  \|\Lambda_{-M}^{-1}X_{-M}'(r + v)\|_{\infty}
            \leq 1} \frac{\|R_Mr\|^2_2}{2} &= -\inf_b \left(\frac{1}{2} \|Xb\|^2_2 + b_M'X_M'v + \frac{1}{2} \|v\|^2_2  + \|\Lambda_{-M}b_{-M}\|_1\right)\\
          \end{aligned}
          $$
          
          

\end{document}
